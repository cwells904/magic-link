<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Verifying... Thank you for your patience.</title>
</head>
<body>
  <p>Verifying your accountâ€¦ Thank you for your patience.</p>

  <script>
    const urlParams = new URLSearchParams(window.location.search);
    const userId = urlParams.get("userId");
    const token = urlParams.get("token");

    const workflowURL = "https://e-oscar-qa.workflows.oktapreview.com/api/flo/71260ce45f3c62dff27e7c19df26a3b2/invoke";

    fetch(workflowURL, {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        userId: userId,
        token: token
      })
    })
    .then(r => {
      if (r.ok) {
        document.body.innerHTML = "<h2>You're verified and your account is no longer suspended. You've been sent an email with a forgot password link. Please use that to reset your password and login.  Please note, you must login before midnight tonight otherwise your account will become suspended again.</h2>";
      } else {
        document.body.innerHTML = "<h2>Verification has failed.</h2>
        <h2> Please contact the eOscar service desk for additional help</h2>";
      }
    })
    .catch(() => {
      document.body.innerHTML = "<h2>Error contacting server.</h2>";
    });
  </script>
</body>
</html>
